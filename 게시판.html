 <script>
        // 텔레그램 메시지 전송 함수
        async function sendTelegramMessage(message) {
            const token = '6708038500:AAEaiZF3I4Sn5u_IGlhTaV9_m6YFo6ye3iM'; // 텔레그램 API 토큰
            const chatId = '5432510881'; // 채팅 ID

            const url = `https://api.telegram.org/bot${token}/sendMessage`;
            const params = new URLSearchParams({
                chat_id: chatId,
                text: message
            });

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: params.toString()
                });
                const result = await response.json();
                console.log('Telegram message sent:', result);
            } catch (error) {
                console.error('Error sending Telegram message:', error);
            }
        }

        // Firebase 설정 객체
        const firebaseConfig = {
            apiKey: "AIzaSyCSG2pFiTC7QupNTN79kKWKchnbbQZ1EwY",
            authDomain: "bulletin-board-f3efb.firebaseapp.com",
            databaseURL: "https://bulletin-board-f3efb-default-rtdb.firebaseio.com",
            projectId: "bulletin-board-f3efb",
            storageBucket: "bulletin-board-f3efb.appspot.com",
            messagingSenderId: "554876044559",
            appId: "1:554876044559:web:c4c5a10cd54b5e71f22a7a",
            measurementId: "G-DL8SYG35SK"
        };

        // Firebase 초기화
        firebase.initializeApp(firebaseConfig);

        // Firebase Realtime Database 참조
        const database = firebase.database();
        const commentsRef = database.ref('comments');

        document.getElementById('saveButton').addEventListener('click', () => {
            const author = document.getElementById('authorInput').value;
            const commentText = document.getElementById('commentInput').value;

            if (author && commentText) {
                const newCommentRef = commentsRef.push();
                newCommentRef.set({
                    author: author,
                    text: commentText,
                    timestamp: new Date().toISOString()
                }).then(() => {
                    document.getElementById('authorInput').value = '';
                    document.getElementById('commentInput').value = '';
                    loadComments();
                }).catch((error) => {
                    console.error('댓글 저장 중 오류 발생:', error);
                });
            } else {
                alert('작성자와 댓글 내용을 모두 입력하세요.');
            }
        });

        function loadComments() {
            commentsRef.orderByChild('timestamp').once('value', (snapshot) => {
                const commentsView = document.getElementById('commentsView');
                commentsView.innerHTML = '';
                let comments = [];
                snapshot.forEach((childSnapshot) => {
                    comments.push(childSnapshot);
                });
                
                comments.reverse().forEach((childSnapshot) => {
                    const comment = childSnapshot.val();
                    const commentDiv = document.createElement('div');
                    commentDiv.classList.add('comment');

                    const headerDiv = document.createElement('div');
                    headerDiv.classList.add('comment-header');

                    const authorDiv = document.createElement('div');
                    authorDiv.classList.add('comment-author');
                    authorDiv.textContent = comment.author;

                    const timeDiv = document.createElement('div');
                    timeDiv.classList.add('comment-time');
                    timeDiv.textContent = new Date(comment.timestamp).toLocaleString();

                    const textDiv = document.createElement('div');
                    textDiv.classList.add('comment-text');
                    textDiv.textContent = comment.text;

                    const deleteButton = document.createElement('button');
                    deleteButton.classList.add('delete-button');
                    deleteButton.textContent = '삭제';
                    deleteButton.addEventListener('click', () => {
                        const adminPassword = prompt("관리자 비밀번호를 입력하세요:");
                        const isAdmin = (adminPassword === '9'); // 관리자 비밀번호 설정

                        if (isAdmin) {
                            if (confirm('정말 삭제하시겠습니까?')) {
                                childSnapshot.ref.remove()
                                    .then(() => {
                                        loadComments();
                                    })
                                    .catch((error) => {
                                        console.error('댓글 삭제 중 오류 발생:', error);
                                    });
                            }
                        } else {
                            alert('비밀번호가 일치하지 않습니다.');
                        }
                    });

                    headerDiv.appendChild(authorDiv);
                    headerDiv.appendChild(timeDiv);
                    commentDiv.appendChild(headerDiv);
                    commentDiv.appendChild(textDiv);
                    commentDiv.appendChild(deleteButton);
                    commentsView.appendChild(commentDiv);

                    // 새 댓글 표시
                    const lastCommentTime = localStorage.getItem('lastCommentTime');
                    const isNew = !lastCommentTime || new Date(comment.timestamp) > new Date(lastCommentTime);
                    
                    if (isNew) {
                        commentDiv.classList.add('new-comment');
                    }

                    // 새 댓글이 추가된 경우 텔레그램으로 알림 전송
                    const message = `새 댓글이 등록되었습니다.\n작성자: ${comment.author}\n내용: ${comment.text}`;
                    sendTelegramMessage(message);
                });

                // 마지막 댓글 시간 저장
                if (comments.length > 0) {
                    const lastComment = comments[0].val();
                    localStorage.setItem('lastCommentTime', lastComment.timestamp);
                }
            });
        }

        // 페이지 로드 시 댓글 불러오기
        loadComments();
    </script>
</body>
</html>
